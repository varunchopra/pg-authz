{% extends "base.html" %}

{% block title %}Sessions{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Active Sessions</h1>
    <div class="actions">
        {% if sessions|length > 1 %}
        <form method="POST" action="{{ url_for('views.dashboard.revoke_other_sessions') }}">
            <button type="submit" class="btn btn-danger" onclick="return confirm('Sign out of all other devices?')">Sign Out Other Devices</button>
        </form>
        {% endif %}
        <a href="{{ url_for('views.dashboard.index') }}" class="btn">Back to Dashboard</a>
    </div>
</div>

{% if sessions %}
<table class="data-table">
    <thead>
        <tr>
            <th>Session ID</th>
            <th>IP Address</th>
            <th>Created</th>
            <th>Expires</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for s in sessions %}
        <tr>
            <td>
                <code>{{ s.session_id[:12] }}...</code>
                {% if s.is_current %}<span style="color: var(--primary); margin-left: 8px;">Current</span>{% endif %}
            </td>
            <td>{{ s.ip_address or 'Unknown' }}</td>
            <td>
                {{ s.created_at.strftime('%Y-%m-%d %H:%M') if s.created_at else 'N/A' }}
                {% if s.user_agent %}
                <div class="meta">{{ s.user_agent[:50] }}{% if s.user_agent|length > 50 %}...{% endif %}</div>
                {% endif %}
            </td>
            <td>{{ s.expires_at.strftime('%Y-%m-%d') if s.expires_at else 'N/A' }}</td>
            <td class="actions">
                <form method="POST" action="{{ url_for('views.dashboard.revoke_session', session_id=s.session_id) }}" style="display: inline;">
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Revoke this session?')">Revoke</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div class="empty-message">No active sessions found.</div>
{% endif %}
{% endblock %}
